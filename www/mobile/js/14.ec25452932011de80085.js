webpackJsonp([14],{EH49:function(t,e){},FZ4H:function(t,e){},Nr3C:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("BO1k"),i=n.n(o),c=n("nv77"),a=n("Q1XB"),l=n.n(a),s=(n("Izdj"),{mixins:["systemConfigMixins"],data:function(){return{active:0,email:"",logining:!1,phone:"",loginType:!0,countryArr:[],callingCode:"86",selectPhoneText:"CN +86",selectPhoneCode:!1,code:"",countDown:0}},computed:{disabled:function(){return!((this.email||this.phone)&&this.code)},canSend:function(){return this.countDown>0}},created:function(){this.$store.commit("setShowFooter",1),this.getCountryArr()},watch:{active:function(t){console.log(t)}},methods:{selectLoginWays:function(t){this.phone=this.email=this.code="",this.loginType=0===t},onClickLeft:function(){this.$router.push("/user/login")},handleLogin:function(){this._login()},_login:function(){var t=this;if(this.verify()){var e={authCode:this.code.trim()};this.loginType?(e.account=this.callingCode+""+this.phone,e.authMode="phone"):(e.account=this.email,e.authMode="email"),Object(c.h)(e).then(function(e){0===e.code&&e.data.token&&(t.$store.commit("setToken",e.data.token),t.$store.commit("setUserInfo",null),t.$router.push("/trade")),t.logining=!1}).catch(function(e){t.logining=!1})}},getCountryArr:function(){this.countryArr=l.a.map(function(t){return t.name})},getCode:function(){this.verify()&&(this._countDown(),this.loginType?this._valiMobile():this._valiEmail())},_valiEmail:function(){var t=this;Object(c.b)({account:this.email,authMode:"email"}).then(function(e){0===e.code&&t.$toast(t.$t("account.sendSuccess"))})},_valiMobile:function(){var t=this;Object(c.b)({account:this.callingCode+""+this.phone,authMode:"phone"}).then(function(e){0===e.code&&t.$toast(t.$t("account.sendSuccess"))})},_countDown:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6e4,n=(new Date).getTime()+e;this.timmer=setInterval(function(){t.countDown=((n-(new Date).getTime())/1e3).toFixed(0),t.countDown<=0&&clearInterval(t.timmer)},1e3)},verify:function(){if(this.loginType){if(!this.callingCode)return void this.$toast.fail(this.$t("account.selectRegion1"));if(!/^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[89])\d{8}$/.test(this.phone))return this.$toast.fail(this.$t("account.phoneFormatError")),!1}else if(!/^.+@\w+\..+$/.test(this.email.trim()))return this.$toast.fail(this.$t("account.emailFormatError")),!1;return!0},onChangeCountry:function(t){var e=!0,n=!1,o=void 0;try{for(var c,a=i()(l.a);!(e=(c=a.next()).done);e=!0){var s=c.value;if(s.name===t){this.callingCode=s.callingCode,this.selectPhoneText=s.code+" +"+s.callingCode;break}}}catch(t){n=!0,o=t}finally{try{!e&&a.return&&a.return()}finally{if(n)throw o}}this.selectPhoneCode=!1}}}),r={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"login"},[n("g-head",[n("van-nav-bar",{attrs:{title:t.$t("account.valiLogin"),"left-arrow":""},on:{"click-left":t.onClickLeft}})],1),t._v(" "),n("van-tabs",{staticClass:"ways",on:{click:t.selectLoginWays},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},[n("van-tab",{attrs:{title:t.$t("account.phoneLogin")}}),t._v(" "),n("van-tab",{attrs:{title:t.$t("account.emailLogin")}})],1),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.loginType,expression:"loginType"}],staticClass:"box"},[n("van-popup",{attrs:{position:"bottom",overlay:!1},model:{value:t.selectPhoneCode,callback:function(e){t.selectPhoneCode=e},expression:"selectPhoneCode"}},[n("van-picker",{attrs:{columns:t.countryArr,"show-toolbar":""},on:{confirm:t.onChangeCountry,cancel:function(e){t.selectPhoneCode=!1}}})],1),t._v(" "),n("van-cell",{attrs:{title:t.$t("account.selectRegion"),"is-link":"",value:t.selectPhoneText},on:{click:function(e){t.selectPhoneCode=!0}}}),t._v(" "),n("van-cell-group",[n("van-field",{attrs:{label:t.$t("account.phoneNumber"),icon:"clear",placeholder:t.$t("account.inputPhoneNumber")},on:{"click-icon":function(e){t.phone=""}},model:{value:t.phone,callback:function(e){t.phone=e},expression:"phone"}})],1)],1),t._v(" "),n("van-cell-group",[n("van-field",{directives:[{name:"show",rawName:"v-show",value:!t.loginType,expression:"!loginType"}],attrs:{label:t.$t("account.email"),icon:"clear",autofocus:"autofocus",placeholder:t.$t("account.inputEmail"),required:""},on:{"click-icon":function(e){t.email=""}},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}}),t._v(" "),n("van-field",{attrs:{center:"",label:t.$t("account.verify"),placeholder:t.$t("account.inputVerify"),icon:"clear"},on:{"click-icon":function(e){t.code=""}},model:{value:t.code,callback:function(e){t.code=e},expression:"code"}},[n("van-button",{attrs:{slot:"button",disabled:t.canSend,size:"small",type:"primary"},on:{click:t.getCode},slot:"button"},[t._v("\n        "+t._s(t.$t("account.sendVerify"))+"\n        "),t.countDown>0?n("span",[t._v(" ("+t._s(t.countDown)+")")]):t._e()])],1)],1),t._v(" "),n("div",{staticClass:"submit"},[n("van-button",{attrs:{type:"primary",disabled:t.disabled},on:{click:t.handleLogin}},[t._v(t._s(t.$t("account.login")))])],1)],1)},staticRenderFns:[]};var u=n("VU/8")(s,r,!1,function(t){n("EH49"),n("FZ4H")},"data-v-6cd0b943",null);e.default=u.exports}});