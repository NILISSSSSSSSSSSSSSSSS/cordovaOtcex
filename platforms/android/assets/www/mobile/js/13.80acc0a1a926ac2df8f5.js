webpackJsonp([13],{WWjs:function(e,t){},n0y5:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("BO1k"),o=i.n(n),s=i("nv77"),a=i("Q1XB"),c=i.n(a),r={data:function(){return{active:0,email:"",password:"",password2:"",code:"",inviteCode:"",inviteFlag:!0,countDown:0,registering:!1,phone:"",registerType:!0,selectPhoneCode:!1,countryArr:[],callingCode:"86",selectPhoneText:"CN +86"}},computed:{disabled:function(){return!((this.email||this.phone)&&this.password&&this.password2&&this.code&&!this.registering)},canSend:function(){return this.countDown>0}},created:function(){var e=this.$route.query.inviteCode;e?(this.inviteFlag=!1,this.inviteCode=e):this.inviteFlag=!0,this.getCountryArr()},destroyed:function(){clearInterval(this.timmer)},methods:{selectRegisterWays:function(e){this.phone="",this.email="",this.password="",this.password2="",this.code="",this.registerType=!e},onClickLeft:function(){this.$router.push("/user/login")},onChangeCountry:function(e){var t=!0,i=!1,n=void 0;try{for(var s,a=o()(c.a);!(t=(s=a.next()).done);t=!0){var r=s.value;if(r.name===e){this.callingCode=r.callingCode,this.selectPhoneText=r.code+" +"+r.callingCode;break}}}catch(e){i=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(i)throw n}}this.selectPhoneCode=!1},getCountryArr:function(){this.countryArr=c.a.map(function(e){return e.name})},handleRegister:function(){this.verify()&&(this.callingCode?(this.registering=!0,this.registerType?this._verifyPhone():this._verifyEmail()):this.$toast.fail(this.$t("account.selectRegion1")))},_verifyEmail:function(){var e=this,t=this.inviteCode;Object(s.g)({code:this.code,email:this.email,inviteCode:t}).then(function(t){0===t.code&&(e.$toast(e.$t("account.registerSuccess")),e._login({email:e.email,passwd:e.sha1(e.password),authMode:"email"})),e.registering=!1}).catch(function(t){e.registering=!1})},_verifyPhone:function(){var e=this,t=this.inviteCode;Object(s.h)({code:this.code,phone:this.callingCode+""+this.phone,inviteCode:t}).then(function(t){0===t.code&&(e.$toast(e.$t("account.registerSuccess")),e._login({phone:e.callingCode+""+e.phone,passwd:e.sha1(e.password),authMode:"phone"})),e.registering=!1}).catch(function(t){e.registering=!1})},getCode:function(){this.verify()&&(this._countDown(),this.registerType?this._registerMobile():this._register())},_register:function(){var e=this;Object(s.c)({email:this.email,passwd:this.sha1(this.password)}).then(function(t){0===t.code&&e.$toast(e.$t("account.sendSuccess"))})},_registerMobile:function(){var e=this;Object(s.d)({phone:this.callingCode+""+this.phone,passwd:this.sha1(this.password)}).then(function(t){0===t.code&&e.$toast(e.$t("account.sendSuccess"))})},_login:function(e){var t=this;Object(s.b)(e).then(function(i){0===i.code&&(i.data.token?(t.$store.commit("setToken",i.data.token),t.$store.commit("setUserInfo",null),t.$router.push("/account")):i.data.expire&&(t.$store.commit("setTwoStep",{email:t.email,expire:i.data.expire,phone:t.callingCode+""+t.phone,authMode:e.authMode}),t.$router.push("/account/two-step")))})},_countDown:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6e4,i=(new Date).getTime()+t;this.timmer=setInterval(function(){e.countDown=((i-(new Date).getTime())/1e3).toFixed(0),e.countDown<=0&&clearInterval(e.timmer)},1e3)},verify:function(){return/^.+@\w+\..+$/.test(this.email.trim())||this.registerType?!/^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[89])\d{8}$/.test(this.phone)&&this.registerType?(this.$toast.fail(this.$t("account.phoneFormatError")),!1):/^\w{6,18}$/.test(this.password)?this.password===this.password2||(this.$toast.fail(this.$t("account.passwordNotSame")),!1):(this.$toast.fail(this.$t("account.passwordToast")),!1):(this.$toast.fail(this.$t("account.emailFormatError")),!1)}}},l={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"register"},[i("g-head",[i("van-nav-bar",{attrs:{title:e.$t("account.register"),"left-arrow":""},on:{"click-left":e.onClickLeft}})],1),e._v(" "),i("van-tabs",{staticClass:"ways",on:{click:e.selectRegisterWays},model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},[i("van-tab",{attrs:{title:e.$t("account.phoneRegister")}}),e._v(" "),i("van-tab",{attrs:{title:e.$t("account.emailRegister")}})],1),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.registerType,expression:"registerType"}],staticClass:"box"},[i("van-popup",{attrs:{position:"bottom",overlay:!1},model:{value:e.selectPhoneCode,callback:function(t){e.selectPhoneCode=t},expression:"selectPhoneCode"}},[i("van-picker",{attrs:{columns:e.countryArr,"show-toolbar":""},on:{confirm:e.onChangeCountry,cancel:function(t){e.selectPhoneCode=!1}}})],1),e._v(" "),i("van-cell",{attrs:{title:e.$t("account.selectRegion"),"is-link":"",value:e.selectPhoneText},on:{click:function(t){e.selectPhoneCode=!0}}}),e._v(" "),i("van-cell-group",[i("van-field",{attrs:{label:e.$t("account.phoneNumber"),icon:"clear",placeholder:e.$t("account.inputPhoneNumber")},on:{"click-icon":function(t){e.phone=""}},model:{value:e.phone,callback:function(t){e.phone=t},expression:"phone"}})],1)],1),e._v(" "),i("van-cell-group",[i("van-field",{directives:[{name:"show",rawName:"v-show",value:!e.registerType,expression:"!registerType"}],attrs:{label:e.$t("account.email"),icon:"clear",placeholder:e.$t("account.inputEmail")},on:{"click-icon":function(t){e.email=""}},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),e._v(" "),i("van-field",{attrs:{type:"password",label:e.$t("account.password"),placeholder:e.$t("account.inputPwd"),icon:"clear"},on:{"click-icon":function(t){e.password=""}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),e._v(" "),i("van-field",{attrs:{type:"password",label:e.$t("account.surePwd"),placeholder:e.$t("account.inputPwdAgain"),icon:"clear"},on:{"click-icon":function(t){e.password2=""}},model:{value:e.password2,callback:function(t){e.password2=t},expression:"password2"}}),e._v(" "),i("van-field",{attrs:{center:"",label:e.$t("account.verify"),placeholder:e.$t("account.inputVerify"),icon:"clear"},on:{"click-icon":function(t){e.code=""}},model:{value:e.code,callback:function(t){e.code=t},expression:"code"}},[i("van-button",{attrs:{slot:"button",disabled:e.canSend,size:"small",type:"primary"},on:{click:e.getCode},slot:"button"},[e._v("\n        "+e._s(e.$t("account.sendVerify"))+"\n        "),e.countDown>0?i("span",[e._v(" ("+e._s(e.countDown)+")")]):e._e()])],1),e._v(" "),i("van-field",{attrs:{label:e.$t("account.inviteCode"),placeholder:e.$t("account.writeInviteCode"),disabled:!e.inviteFlag,icon:e.inviteFlag?"clear":""},on:{"click-icon":function(t){e.inviteFlag&&(e.inviteCode="")}},model:{value:e.inviteCode,callback:function(t){e.inviteCode=t},expression:"inviteCode"}})],1),e._v(" "),i("div",{staticClass:"submit"},[i("van-button",{attrs:{type:"primary",disabled:e.disabled},on:{click:e.handleRegister}},[e._v(e._s(e.$t("account.register")))])],1)],1)},staticRenderFns:[]};var u=i("VU/8")(r,l,!1,function(e){i("swix"),i("WWjs")},"data-v-65132816",null);t.default=u.exports},swix:function(e,t){}});